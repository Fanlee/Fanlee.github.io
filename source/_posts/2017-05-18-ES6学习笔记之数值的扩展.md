---
title: ES6学习笔记之数值的扩展
date: 2017-05-18
categories: 学习笔记
tags: ES6
keywords: ES6
comments: true

---
## ES5中的Number类型
`Number`采用IEEE754格式来表示整数和浮点数。
整数可以通过十进制、八进制、十六进制字面量来表示。

八进制字面量第一位必须是`0`，如果字面值中的数值超过范围，前导的零将会被省略，后面数值当作十进制解析。
```
console.log(070); // 56
console.log(08); // 8
console.log(089)； // 89
```
八进制字面量在严格模式下会报错

十六进制字面量前两位必须是`0x`,超出字面量会报错。
```
console.log(0xF); // 15
console.log(0xG); // Uncaught SyntaxError: Invalid or unexpected token
```

在进行算术计算的时候，八进制和十六进制的数值最终都会转换成十进制。

### 浮点数值
浮点数值需要的内存空间是保存整数值的两倍，如果小数点后面没有任何数值，或者浮点数本身就表示一个整数，那么都会转换为整数。
```
console.log(10.); // 10
console.log(10.0); // 10
```
### 数值范围
`ECMAScripot`的数值范围在`Number.MIN_VALUE`和`Number.MAX_VALUE`之间，如果超出这个范围， 将会被转换成`Infinity`值，该值不能用于计算，要想确定一个值是否是有穷的，通过`isFinite()`判断，函数参数位于最大值与最小值之间返回`true`。
```
console.log(Number.MIN_VALUE); // 5e-324
console.log(Number.MAX_VALUE); // 1.7976931348623157e+308
console.log(isFinite(Number.MIN_VALUE + Number.MIN_VALUE)); // false
```
### NaN
这个数值表示一个本来要返回数值的操作数未返回数值的情况。

 1. 任何涉及到NaN的操作都会返回`NaN`
 2. `NaN`与任何值都不相等，包括自身
```
console.log(NaN === NaN) // false
```
`ECMAScript`定义了`isNaN()`函数，该函数接收一个参数，会尝试将这个参数转换成数值，转换成功返回`false`, 失败返回`true`。
```
console.log(isNaN(NaN)); // true
console.log(isNaN(10)); // false
console.log(isNaN('10')); // false
console.log(isNaN('color')); // true
console.log(isNaN(true)); // false
```
### 数值转换
有三个函数可以把非数值转换为数值：`Number()`、`parseInt()`和`parseFloat()`。`Number()`可用于任何数据类型，另两个则专门用于把字符串转换成数值。

`Number()`转换规则如下：

 1. 如果是Boolean值，则把`true`和`false`转换成1和0
 2. 如果是数值，返回本身
 3. 如果是`Null`， 返回0
 4. 如果是`undefined`，返回`NaN`
 5. 如果是字符串，则有一下几种情况
    - 如果字符串中只包含数字，则转换成对应十进制
    
    ```
    console.log(Number("10")); // 10
    console.log(Number("+10")); //10
    console.log(Number("-10")); // -10
    console.log(Number("010")); // 10
    ```
    - 如果字符串中包含有效的浮点格式，则转换成对应的浮点数值。
    
    ```
    console.log(Number("10.3")); // 10.3
    console.log(Number("+10.3")); // 10.3
    console.log(Number("-10.3")); //-10.3
    console.log(Number("010.3")); // 10.3
    ```
    - 如果字符串中包含有效的十六进制格式，则转换成相同大小的十进制整数值。
    
    ```
    console.log(Number("0xF")); // 15
    ```
    - 如果字符串为空，则转换为0
    
    ```
    console.log(Number(" ")); // 0
    ```
    - 字符串中包含除上述格式之外的字符， 则转换为`NaN`
 6. 如果是对象， 则调用对象的`valueOf()`方法，然后按照前面规则转换，如果转换结果是`NaN`，则调用对象的`toString()`方法，再次依照前面规则转换。日期对象会转换成相应的毫秒数。
 
```
let now = new Date();
console.log(Number(now)); // 1495076392196
```

`parseInt()`函数在转换字符串时会忽略字符串前面的空格，直到找到第一个非空格字符串。如果第一个字符不是数字字符或者负号，就会返回`NaN`，如果第一个字符是数字字符，`parseInt()`会继续解析后面的字符，直到解析完所有字符或者遇到非数字字符。`parseInt()`解析空字符串会返回`NaN`。同样，`parseInt()`也能辨别各种整数格式。
```
console.log(parseInt("")); // NaN
console.log(parseInt("123abc")); // 123
console.log(parseInt("abc123")); // NaN
console.log(parseInt("10.2")); // 10
console.log(parseInt("070")); // 70 (ECMAScript5已经不具备解析八进制的能力，所以认为前导的0无效)
console.log(parseInt("0xFWQR")); // 15
```
`parseInt()`可以接受第二个参数来指定整数的格式。默认是转换成十进制。
```
console.log(parseInt("10", 2)); // 2
console.log(parseInt("10", 8)); // 8
console.log(parseInt("10", 10)); // 10
console.log(parseInt("10", 16)); // 16
```
`parseFloat()`函数与`parseInt()`类似，不同的是`parseFloat()`解析完成或者遇到第一个无效的浮点数字字符为止，但是第一个小数点是有效的。`parseFloat()`始终会忽略前导的零，十六进制的字符串始终会被转换成0，由于`parseFloat()`只解析十进制值，所以布恩那个指定第二个参数，如果字符串包含的是一个可解析成整数的数值，`parseFloat()`会返回整数。
```
console.log(parseFloat("123abc")); // 123
console.log(parseFloat("0xF")); // 0
console.log(parseFloat("10.5")); // 10.5
console.log(parseFloat("10.5.5")); // 10.5
console.log(parseFloat("010.5")); // 10.5
console.log(parseFloat("10.0")); // 10
```


----------
## ES6数值扩展
### 二进制和八进制表示法
ES6提供了新的二进制和八进制数值的新写法，分别用0b和0o表示。
```
console.log(0b0001); // 1
console.log(0o70); // 56
```
要把二进制和八进制转换成十进制，调用Number()方法。
```
console.log(Number(0b0001)); // 1
console.log(Number(0o70)); // 56
```
### Number.isFinite()、Number.isNaN()
这两个方法与传统的全局方法`isFinite()`和`isNaN()`相比，这两个新方法只对数值有效。
```
console.log(isFinite("10")); // true
console.log(Number.isFinite("10")); // false

console.log(isNaN("NaN")); // true
console.log(Number.isNaN("NaN")); // false
```
### Number.parseInt(), Number.parseFloat()
与ES5`parseInt()`和`parseFloat()`行为完全一样。这样做的目的，是逐步减少全局性方法，使得语言逐步模块化。
### Number.isInteger()
用来判断一个数是否为整数。同样能够识别不同格式的整数，如果第一位是零，则忽略。
```
console.log(Number.isInteger(10)); // true
console.log(Number.isInteger("10")); // false
console.log(Number.isInteger(10.0)); // true
console.log(Number.isInteger(10.1)); // false
console.log(Number.isInteger(010)); // true
console.log(Number.isInteger(0xF)); // true
```
### Number.EPSILON
引入一个这么小的量的目的，在于为浮点数计算，设置一个误差范围。如果浮点数的计算误差小于`Number.EPSILON`，我们就可以认为等到了正确的结果。
```
console.log(Number.EPSILON); // 2.220446049250313e-16
```
### 安全整数和Number.isSafeInteger()
ES6引入了`Number.MAX_SAFE_INTEGER`和`Number.MIN_SAFE_INTEGER`这两个常量，用来表示安全整数范围的上下限。
```
console.log(Number.MAX_SAFE_INTEGER); // 9007199254740991
console.log(Number.MIN_SAFE_INTEGER); // -9007199254740991
```
`Number.isSafeInteger()`则是用来判断一个整数是否落在这个范围之内。
```
console.log(Number.isSafeInteger(Number.MAX_SAFE_INTEGER + 1)); //false
```
验证的时候不止要验证结果是否为安全数，还要验证参与计算的值是否为安全数。


----------


ES6在Math对象上新增了17个与数学相关的方法，新增了4个对数相关方法，新增了6个三角函数方法，一个指数运算符。
具体请参考[MDN][1]


  [1]: https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Math